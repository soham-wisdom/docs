---
title: "Subscribe Conversation"
description: "Subscribe to real-time conversation updates as messages are sent and received"
---

## Overview

The `subscribeConversation` subscription allows you to listen for real-time updates to a conversation, including new messages and response streams, via a WebSocket-based subscription model.

The API requires authentication using a **session token** obtained via the Descope authentication system.

## Authentication Flow

1. **Obtain Session Token**
   - Use the `exchange_access_key` method from Descope to exchange an access key for a session token.
   - Python Example:

     ```python
     from descope import DescopeClient
     descope_client = DescopeClient(project_id=WISDOM_PROJECT_ID)
     auth_info = descope_client.exchange_access_key(WISDOM_AUTH_KEY)
     auth_token = auth_info["sessionToken"]["jwt"]
     ```
2. **Pass Token in Requests**
   - The session token is required in the WebSocket connection payload and query parameters.

## Signature

```graphql
subscribeConversation(
  auth: SubscriptionAuthInput!
  conversationId: String!
): [ConversationUpdateOneOf!]!
```

## Arguments

<ParamField path="auth" type="SubscriptionAuthInput!" required>
  Authentication credentials for the subscription. See [SubscriptionAuthInput](/integrations/graphql-api/objects/subscription-auth-input).
</ParamField>

<ParamField path="conversationId" type="String!" required>
  The unique identifier of the conversation to subscribe to.
</ParamField>

## Response

Returns an array of `ConversationUpdateOneOf` objects representing conversation updates. See [ConversationUpdateOneOf](/integrations/graphql-api/objects/conversation-update-one-of) for the schema.

## Usage Example

Subscribe to a conversation to receive real-time message updates:

```graphql
subscription SubscribeConversation(
  $auth: SubscriptionAuthInput!
  $conversationId: String!
) {
  subscribeConversation(
    auth: $auth
    conversationId: $conversationId
  ) {
    assistantMessageSent {
      id
      body {
        ops {
          insert {
            text
            visualization {
              id
              title
              type
            }
          }
        }
      }
      sender
      createdAt
    }
    assistantResponseDiff {
      bodyDiff {
        ops {
          insert {
            text
          }
        }
      }
      sender
      inProgress
    }
    assistantResponseCancelled
  }
}
```

<RequestExample>

```bash Request
wscat -c wss://{ACCOUNT}.askwisdom.ai/graphql \
  -H "Authorization: Bearer your_api_key" \
  -s graphql-ws \
  --execute '{
    "type": "start",
    "payload": {
      "query": "subscription SubscribeConversation($auth: SubscriptionAuthInput!, $conversationId: String!) { subscribeConversation(auth: $auth, conversationId: $conversationId) { assistantMessageSent { id body { ops { insert { text } } } sender createdAt } assistantResponseDiff { bodyDiff { ops { insert { text } } } sender inProgress } assistantResponseCancelled } }",
      "variables": {
        "auth": {
          "token": "your_jwt_token_here"
        },
        "conversationId": "conv_123456789"
      }
    }
  }'
```

</RequestExample>

<ResponseExample>

```json Response
{
  "data": {
    "subscribeConversation": [
      {
        "assistantMessageSent": {
          "id": "msg_987654321",
          "body": {
            "ops": [
              {
                "insert": {
                  "text": "Here's the analysis you requested:"
                }
              }
            ]
          },
          "sender": "ASSISTANT",
          "createdAt": "2024-01-15T10:30:00Z"
        },
        "assistantResponseDiff": null,
        "assistantResponseCancelled": null
      }
    ]
  }
}
```

</ResponseExample>

## Related Operations

<CardGroup cols={2}>
  <Card title="ConversationUpdateOneOf Schema" icon="cube" href="/integrations/graphql-api/objects/conversation-update-one-of">
    Learn about conversation update types
  </Card>
</CardGroup>
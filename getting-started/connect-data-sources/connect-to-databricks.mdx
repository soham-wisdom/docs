---
title: "Connect WisdomAI to Databricks"
---

WisdomAI connects to Databricks using a **Client ID** and **Client Secret** for authentication. This method ensures secure and granular control over the data WisdomAI can access.

## Prerequisites

Before you begin, ensure you have the following:

- An active Databricks workspace.
- Permissions to create and manage **Service Principals** within your Databricks account or workspace.
- A Databricks **SQL Warehouse** set up and running.

---

## 1. Obtain Databricks Connection Details

You will need the following four pieces of information from your Databricks environment:

- **Host**: The URL of your Databricks workspace, which typically looks like `https://<region>.cloud.databricks.com/`.
- **HTTP Path**: The specific path to your SQL Warehouse, usually starting with `/sql/1.0/warehouses/`.
- **Client ID**: The Application ID of your Databricks Service Principal.
- **Client Secret**: The secret key generated for your Service Principal.

### How to Find Your Connection Details

#### Host and HTTP Path

1. Navigate to your Databricks Workspace.
2. Go to **SQL Warehouses**.
3. Select the warehouse you want to connect to.
4. Click on the **Connection Details** tab. Here you will find the **Server Hostname** (your Host) and the **HTTP Path**.

#### Client ID and Client Secret

You'll first need to create a Service Principal in Databricks.

**Step 1: Create a Service Principal**

1. Log in to your Databricks workspace as an administrator.
2. Navigate to **Admin Settings** \> **Identity and access** \> **Service principals**.
3. Click **Add Service Principal**.
4. Select **Databricks managed** and give it a descriptive name (e.g., `WisdomAI-ServicePrincipal`).
5. Click **Add**.
6. The **Application ID** shown is your **Client ID**. Copy this value.

**Step 2: Generate a Client Secret**

1. From the service principal's page, go to the **Secrets** tab.
2. Under OAuth secrets, click **Generate secret**.
3. Set a lifetime for the secret (up to 730 days) and click **Generate**.
4. Immediately copy the displayed secret. This is your **Client Secret**.

<Warning>
  The Client Secret is only shown once and cannot be retrieved later. Please store it in a secure location immediately.
</Warning>

---

## 2. Assign Permissions in Databricks

The Service Principal needs specific permissions to access the required data.

- **Warehouse Permissions**: Grant **CAN USE** permission to the Service Principal on the SQL Warehouse you are connecting to. You can do this from the **Permissions** tab of the SQL Warehouse.
- **Data Privileges**: The service principal requires the following privileges in Unity Catalog:
  - `USE CATALOG` on the target catalog.
  - `USE SCHEMA` on the target schema.
  - `SELECT` on the tables and views you want WisdomAI to access.

You can grant these permissions using SQL commands:

```sql
-- Grant permission to use a specific catalog
GRANT USAGE ON CATALOG <your_catalog_name> TO `<service_principal_id>`;

-- Grant permission to use a specific schema
GRANT USAGE ON SCHEMA <your_catalog_name>.<your_schema_name> TO `<service_principal_id>`;

-- Grant select permission on all tables in a schema
GRANT SELECT ON ALL TABLES IN SCHEMA <your_catalog_name>.<your_schema_name> TO `<service_principal_id>`;
```

### 3. Connect WisdomAl to Databricks

Once you have gathered the required information, you can configure the connection in WisdomAl:

1.  In WisdomAl, navigate to the Connections section and click **Add Connection**.
2.  Select **Databricks** as the data source type.
3.  Fill in the connection details in the "Databricks connection details" section.
    * **Connection Name**: Choose a descriptive name for your connection (e.g., "Databricks Prod").
    * **Host**: Paste the Server Hostname you obtained from Databricks.
    * **HTTP Path**: Paste the HTTP Path for your SQL Warehouse.
    * **Client ID**: Enter your Client ID (Application ID). This field is mandatory.
    * **Client Secret**: Enter your Client Secret (the value copied immediately after creation). This field is mandatory.
    * **Catalog Filters (Optional)**: Specify any Catalog Filters if you want to further restrict the catalogs/schemas WisdomAl crawls.
4.  Click **Save and Sync metadata**. WisdomAl will use the provided credentials to connect to Databricks and scan the metadata of the specified catalogs and tables.

---

### Security Considerations and Best Practices
* **Least Privilege**: Always follow the principle of least privilege. Only grant the necessary permissions to the Service Principal.
* **Secure Key Management**: Treat your Client ID and Client Secret like passwords. Avoid sharing them via insecure channels like unencrypted email. Use secure methods like LastPass or other secure file sharing services.
* **Credential Rotation**: Regularly rotate your Client Secrets to enhance security, especially before their expiration.

---

### Troubleshooting Common Issues

**Authentication Failed or Invalid Credentials:**
* Ensure the Host, HTTP Path, Client ID, and Client Secret are complete and correct.
* No extra characters, spaces, or missing lines.
* Verify that the Client Secret has not expired or been revoked in Databricks.
* Confirm that the Service Principal exists and is enabled in Databricks.

**Permission Denied Errors:**
* Double-check that the Service Principal has the necessary `CAN USE` permission on the SQL Warehouse.
* Verify that the Service Principal has the correct `USE CATALOG`, `USE SCHEMA`, and `SELECT` privileges on the Databricks catalogs, schemas, and tables you are trying to access.
* Confirm that the SQL Warehouse is running and accessible.

**Catalog Not Found or Table Not Found:**
* Verify the spelling of the catalog or table names.
* If using catalog filters in WisdomAl, ensure the catalog is included in the filter.
* Confirm that the Service Principal has permissions on the specific catalog you are trying to access.

**Connection Timeout or Network Errors:**
* Verify that WisdomAl's CIDR block (35.238.115.103/32 34.82.248.105/32) is allowlisted in your Snowflake network policies or any corporate firewalls.